{% extends 'layout-2-1-bleedbar.html' %}
{% import 'atoms/partially-styled-link.html' as partially_styled_link with context %}
{% import 'macros/category-icon.html' as category_icon %}
{% import 'templates/render_block.html' as render_block with context %}
{% import 'ask/ask-search.html' as ask_search_bar with context %}

{% block content_modifiers -%}
    {{ super() }} ask-cfpb-page ask-cfpb-page__landing
{%- endblock %}

{% block hero -%}
    {% for block in page.header -%}
        {{ render_block.render(block, loop.index) }}
    {%- endfor %}
{% endblock %}

{% block content_main %}
    <div class="content-l">
        <section class="ask-categories">
            <h2 class="u-show-on-mobile u-mt30">
                {{ _('Browse questions by category') }}
            </h2>
            <ul class="u-show-on-mobile category_list m-list m-list__links u-mb0">
                {% for topic_page in topic_pages %}
                    {% set topic = topic_page.portal_topic %}
                    {% set featured_answers = topic.featured_answers(page.language) %}
                    {% if featured_answers %}
                    <li class="m-list_item">
                        <a class="m-list_link
                                  a-link
                                  a-link__jump
                                  a-link__icon-after-text"
                            href="{{ topic_page.url }} "
                            <span class="a-link_text">
                                {{ topic.title(page.language) }}
                            </span>
                            {{ category_icon.render(topic) }}
                        </a>
                    </li>
                    {% endif %}
                {% endfor %}
            </ul>

            <div class="question-categories">
                <div class="u-hide-on-mobile">

                    <div class="content-l content-l__equal-height">

                        {% for topic_page in topic_pages %}
                            {% set topic = topic_page.portal_topic %}
                            {% set featured_answers = topic.featured_answers(page.language) %}
                            {% if featured_answers %}
                                <div class="content-l_col content-l_col-1-2 content-l_col__equal-height">
                                    <article class="m-card content-l_body__equal-height">

                                        <h2>
                                            <a href="{{ topic_page.url }}">
                                            {{ category_icon.render( topic ) }}
                                            {{ topic.title(page.language) }}
                                            </a>
                                        </h2>

                                        <ul class="m-list question_list m-list__flush-left u-mt10 u-mb30">
                                            {% for page in featured_answers %}
                                                <li class="m-list_item">
                                                {{ partially_styled_link.render({
                                                    'plain_text': page.question,
                                                    'underlined_text': _('Read answer'),
                                                    'url': page.url})
                                                }}
                                                </li>
                                            {% endfor %}
                                        </ul>

                                        <div class="content-l_footer__equal-height">
                                            <p class="short-desc u-mb0">
                                                <a href="{{ topic_page.url }}">
                                                {% if page.language == 'es' %}
                                                    Ver todas las respuestas de {{ topic.title(page.language)|lower }}
                                                {% else %}
                                                    See all {{ topic.title(page.language)|lower }} questions
                                                {% endif %}
                                                </a>
                                            </p>
                                        </div>

                                    </article>
                                </div>
                            {% endif %}

                        {% endfor %}

                    </div>

                </div>

            </div>
        </section>

        <section class="ask-search block block__sub block__flush-bottom">
            <h2>{{ _('Don\'t see what you\'re looking for?') }}</h2>
            {{ ask_search_bar.render( language=page.language ) }}
        </section>

        
    </div>

{% endblock %}

{% block content_sidebar_modifiers -%}
    o-sidebar-content
{%- endblock %}

{% block content_sidebar scoped -%}
<div class="block block__flush-top u-mb45 about-us-text">
    {% if about_us %}
        {{ about_us.text | richtext }}
    {% endif %}
</div>
<div class="block block__border-top block__padded-top disclaimer-text">
    {% if disclaimer %}
        <h3 class="h4">{{ disclaimer.sidefoot_heading }}</h3>
        {{ disclaimer.text | richtext }}
    {% endif %}
</div>
{%- endblock %}
