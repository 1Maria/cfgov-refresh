{% extends 'layout-side-nav.html' %}

{% import 'molecules/featured-content.html' as featured_content %}
{% import 'templates/streamfield-sidefoot.html' as streamfield_sidefoot with context %}

{% block title -%}
    {{ page.seo_title if page.seo_title else page.title }}
{%- endblock %}

{% block content_main_modifiers -%}
    {{ super() }} content__flush-bottom
{%- endblock %}

{% block content_main %}
    {% for block in page.header %}
        {% if 'featured_content' in block.block_type %}
            <div class="block
                        block__flush-sides">
                {{ featured_content.render(block.value) }}
            </div>
        {% elif loop.index == 1 %}
        <div class="block
                    block__flush-top">
            {{ render_stream_child(block) }}
        </div>
        {% endif %}
    {% endfor %}
    {% for block in page.content %}
        {% if 'filter_controls' in block.block_type %}
            <div class="block
                    block__flush-top">

                {% set f = forms.pop(0) %}
                {% from 'organisms/filterable-list-controls.html' import render as flc with context %}
                {{ flc(block.value, f, loop.index0) }}
            </div>
        {% else %}
            {% include 'templates/render_block.html' with context %}
        {% endif %}
    {% endfor %}
    {% if page.sidefoot %}
        <aside class="prefooter">
            {{ streamfield_sidefoot.render(page.sidefoot, half_width=true) }}
        </aside>
    {% if page.sidefoot %}
{% endblock %}
