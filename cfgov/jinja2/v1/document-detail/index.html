{% extends 'layout-2-1-bleedbar.html' %}

{% import 'molecules/related-posts.html' as related_posts with context %}
{% import 'molecules/related-metadata.html' as related_metadata with context %}

{% if not breadcrumb_items %}
    {% set parent = page.parent() %}
    {% set breadcrumb_items = [(parent.url, parent.url, parent.title)] %}
{% endif %}

{% block title -%}
    {{ page.seo_title }}
{%- endblock %}

{# TODO: Remove lipsumText when and if it is no longer needed. #}
{% set lipsumText = lipsum(1, false, 10, 25) | safe %}

{% block content_main %}
    {% for block in page.header -%}
            <div class="block
                        block__flush-top">
                {{ render_stream_child(block) }}
            </div>
    {%- endfor %}

    {% for block in page.content -%}
        <div class="block">
            {{ render_stream_child(block) }}
        </div>
    {%- endfor %}
{% endblock %}

{% block content_sidebar_modifiers -%}
    o-sidebar-content
{%- endblock %}

{% block content_sidebar scoped -%}
    {# TODO: Add Related Metadata and Topics Sidebar molecules. #}
    {% for block in page.sidefoot %}
        <div class="block block__flush-top">
            {% if 'related_posts' in block.block_type %}
                {{ related_posts.render(block) }}
            {% else %}
                {% if 'heading' in block.block_type %}
                    <h3 class="o-sidebar-breakout_heading">
                        {{ render_stream_child(block) }}
                    </h3>
                {% elif 'slug' in block.block_type %}
                    <h2 class="header-slug">
                        <span class="header-slug_inner">
                            {{ render_stream_child(block) }}
                        </span>
                    </h2>
                {% elif 'paragraph' in block.block_type %}
                    {{ render_stream_child(block) }}
                {% else %}
                    {{ render_stream_child(block) }}
                {% endif %}
            {% endif %}
        </div>
    {% endfor %}
{%- endblock %}
